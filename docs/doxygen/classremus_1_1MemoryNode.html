<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Remus: remus::MemoryNode Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style-sheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Remus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classremus_1_1MemoryNode.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-types">Protected Types</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classremus_1_1MemoryNode-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">remus::MemoryNode Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a> is a machine that provides Segments for ComputeNodes.  
 <a href="classremus_1_1MemoryNode.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="mem__node_8h_source.html">mem_node.h</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for remus::MemoryNode:</div>
<div class="dyncontent">
<div class="center"><img src="classremus_1_1MemoryNode__coll__graph.png" border="0" usemap="#aremus_1_1MemoryNode_coll__map" alt="Collaboration graph"/></div>
<map name="aremus_1_1MemoryNode_coll__map" id="aremus_1_1MemoryNode_coll__map">
<area shape="rect" title="A MemoryNode is a machine that provides Segments for ComputeNodes." alt="" coords="97,93,256,119"/>
<area shape="rect" href="structremus_1_1MachineInfo.html" title="A simple struct that contains the information needed to identify a machine in the remus system." alt="" coords="5,5,156,31"/>
<area shape="poly" title=" " alt="" coords="105,38,165,91,162,95,102,42"/>
<area shape="rect" href="classremus_1_1internal_1_1Segment.html" title="A Segment object to represent a slab of RDMA memory." alt="" coords="181,5,367,31"/>
<area shape="poly" title=" " alt="" coords="252,42,192,95,188,91,249,38"/>
</map>
<center><span class="legend">[<a target="top" href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structremus_1_1MemoryNode_1_1IdContext.html">IdContext</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">A context to associate with a connection.  <a href="structremus_1_1MemoryNode_1_1IdContext.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structremus_1_1MemoryNode_1_1SegInfo.html">SegInfo</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="structremus_1_1MemoryNode_1_1SegInfo.html" title="SegInfo is a convenience type for associating a MemoryRegistration with one of the remote-accessible ...">SegInfo</a> is a convenience type for associating a MemoryRegistration with one of the remote-accessible Segments stored in this <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a>.  <a href="structremus_1_1MemoryNode_1_1SegInfo.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:acf7b65b8b4ebdd9b75253f75fe4f907a" id="r_acf7b65b8b4ebdd9b75253f75fe4f907a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#acf7b65b8b4ebdd9b75253f75fe4f907a">~MemoryNode</a> ()</td></tr>
<tr class="memdesc:acf7b65b8b4ebdd9b75253f75fe4f907a"><td class="mdescLeft">&#160;</td><td class="mdescRight">TODO: Need to make sure all fields get reclaimed/destructed properly.  <br /></td></tr>
<tr class="separator:acf7b65b8b4ebdd9b75253f75fe4f907a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23a92b1a0c0f6c5ecca7927dac3c97ed" id="r_a23a92b1a0c0f6c5ecca7927dac3c97ed"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a23a92b1a0c0f6c5ecca7927dac3c97ed">MemoryNode</a> (const <a class="el" href="structremus_1_1MachineInfo.html">MachineInfo</a> &amp;self, std::shared_ptr&lt; <a class="el" href="classremus_1_1ArgMap.html">remus::ArgMap</a> &gt; args)</td></tr>
<tr class="separator:a23a92b1a0c0f6c5ecca7927dac3c97ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef24f2bc7597006bb687de2978e1a051" id="r_aef24f2bc7597006bb687de2978e1a051"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structremus_1_1internal_1_1RegionInfo.html">internal::RegionInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#aef24f2bc7597006bb687de2978e1a051">get_local_rkeys</a> ()</td></tr>
<tr class="separator:aef24f2bc7597006bb687de2978e1a051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae40a6aea42e7f99305c5fad74d345dd" id="r_aae40a6aea42e7f99305c5fad74d345dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#aae40a6aea42e7f99305c5fad74d345dd">init_done</a> ()</td></tr>
<tr class="separator:aae40a6aea42e7f99305c5fad74d345dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-types" name="pro-types"></a>
Protected Types</h2></td></tr>
<tr class="memitem:a0b1e24af0fbdf3cd85642e0c47d32869" id="r_a0b1e24af0fbdf3cd85642e0c47d32869"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a0b1e24af0fbdf3cd85642e0c47d32869">ConnPtr</a> = std::shared_ptr&lt; <a class="el" href="classremus_1_1internal_1_1Connection.html">internal::Connection</a> &gt;</td></tr>
<tr class="memdesc:a0b1e24af0fbdf3cd85642e0c47d32869"><td class="mdescLeft">&#160;</td><td class="mdescRight">A shared pointer to a Connection object.  <br /></td></tr>
<tr class="separator:a0b1e24af0fbdf3cd85642e0c47d32869"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a1e8e4d698d5ab2d8d18af4e750dc45a7" id="r_a1e8e4d698d5ab2d8d18af4e750dc45a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a1e8e4d698d5ab2d8d18af4e750dc45a7">handle_connections</a> ()</td></tr>
<tr class="separator:a1e8e4d698d5ab2d8d18af4e750dc45a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af533ae0d6e83d23a038b5747666a4ac0" id="r_af533ae0d6e83d23a038b5747666a4ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#af533ae0d6e83d23a038b5747666a4ac0">on_connect</a> (rdma_cm_id *id, rdma_cm_event *event, ibv_pd *pd)</td></tr>
<tr class="memdesc:af533ae0d6e83d23a038b5747666a4ac0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Handler to run when a connection request arrives.  <br /></td></tr>
<tr class="separator:af533ae0d6e83d23a038b5747666a4ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4f416826460d2ef587b93fb955d61a1" id="r_af4f416826460d2ef587b93fb955d61a1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#af4f416826460d2ef587b93fb955d61a1">on_disconnect</a> (rdma_cm_id *id)</td></tr>
<tr class="separator:af4f416826460d2ef587b93fb955d61a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac50a81d813704cea668101626284a6b7" id="r_ac50a81d813704cea668101626284a6b7"><td class="memItemLeft" align="right" valign="top">rdma_cm_id *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#ac50a81d813704cea668101626284a6b7">listen_id_</a> = nullptr</td></tr>
<tr class="separator:ac50a81d813704cea668101626284a6b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71a29d9d6cb6e74578928cc957785a4d" id="r_a71a29d9d6cb6e74578928cc957785a4d"><td class="memItemLeft" align="right" valign="top">rdma_event_channel *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a71a29d9d6cb6e74578928cc957785a4d">listen_channel_</a> = nullptr</td></tr>
<tr class="separator:a71a29d9d6cb6e74578928cc957785a4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47b58ac09270e6e99f558b8a41883ebd" id="r_a47b58ac09270e6e99f558b8a41883ebd"><td class="memItemLeft" align="right" valign="top">std::thread&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a47b58ac09270e6e99f558b8a41883ebd">runner_</a></td></tr>
<tr class="separator:a47b58ac09270e6e99f558b8a41883ebd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a2833d8b39669f868cd575eb873ffa9" id="r_a3a2833d8b39669f868cd575eb873ffa9"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a3a2833d8b39669f868cd575eb873ffa9">address_</a></td></tr>
<tr class="separator:a3a2833d8b39669f868cd575eb873ffa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa85b3cd8d63c1ea851247fb53a18dc6f" id="r_aa85b3cd8d63c1ea851247fb53a18dc6f"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#aa85b3cd8d63c1ea851247fb53a18dc6f">port_</a></td></tr>
<tr class="separator:aa85b3cd8d63c1ea851247fb53a18dc6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9c44330824bf3f474ebcb873a39d418" id="r_ac9c44330824bf3f474ebcb873a39d418"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structremus_1_1internal_1_1RegionInfo.html">internal::RegionInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#ac9c44330824bf3f474ebcb873a39d418">ris_</a></td></tr>
<tr class="separator:ac9c44330824bf3f474ebcb873a39d418"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5df18d9fbe4af76ef18634ba9b62adae" id="r_a5df18d9fbe4af76ef18634ba9b62adae"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a5df18d9fbe4af76ef18634ba9b62adae">remaining_conns_</a></td></tr>
<tr class="separator:a5df18d9fbe4af76ef18634ba9b62adae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb46341d958400600fa89364b056a8b" id="r_a3eb46341d958400600fa89364b056a8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structremus_1_1MachineInfo.html">MachineInfo</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a3eb46341d958400600fa89364b056a8b">self_</a></td></tr>
<tr class="separator:a3eb46341d958400600fa89364b056a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aafd78320081297747eb7c00c7731070d" id="r_aafd78320081297747eb7c00c7731070d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classremus_1_1MemoryNode.html#a0b1e24af0fbdf3cd85642e0c47d32869">ConnPtr</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#aafd78320081297747eb7c00c7731070d">conns_</a></td></tr>
<tr class="separator:aafd78320081297747eb7c00c7731070d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dfa9a041602a192628cabd0aa023469" id="r_a2dfa9a041602a192628cabd0aa023469"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structremus_1_1MemoryNode_1_1SegInfo.html">SegInfo</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#a2dfa9a041602a192628cabd0aa023469">segs_</a></td></tr>
<tr class="separator:a2dfa9a041602a192628cabd0aa023469"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3ee26e30d727d8072172fc4628e6e51" id="r_ad3ee26e30d727d8072172fc4628e6e51"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classremus_1_1internal_1_1Segment.html">internal::Segment</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#ad3ee26e30d727d8072172fc4628e6e51">send_seg_</a></td></tr>
<tr class="separator:ad3ee26e30d727d8072172fc4628e6e51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb735c7ec2ee8e43492901be1cd53521" id="r_abb735c7ec2ee8e43492901be1cd53521"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceremus_1_1internal.html#ad19c6642dcb03734777590a5a5fecb62">internal::ibv_mr_ptr</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#abb735c7ec2ee8e43492901be1cd53521">mr_</a></td></tr>
<tr class="separator:abb735c7ec2ee8e43492901be1cd53521"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa11e003bb3358d96ba8cc043f824fa09" id="r_aa11e003bb3358d96ba8cc043f824fa09"><td class="memItemLeft" align="right" valign="top">const uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classremus_1_1MemoryNode.html#aa11e003bb3358d96ba8cc043f824fa09">total_threads_</a></td></tr>
<tr class="separator:aa11e003bb3358d96ba8cc043f824fa09"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a> is a machine that provides Segments for ComputeNodes. </p>
<p><a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a> provides a collection of Segments that can be accessed by Compute Nodes. Each Segment must be pinned, registered with the RNIC, and assigned an rkey that Compute Nodes must provide in order to operate on it.</p>
<p>Memory Nodes are visible to Compute Nodes, but Compute Nodes are not necessarily visible to Memory Nodes, and Memory Nodes are not visible to each other. Each Memory Node will have a listening id (think "socket"), and Compute Nodes can connect to that id to create their own dedicated ids for interacting with the Memory Node. Each such id will support both two-sided and one-sided communication. This is necessary, because one cannot perform one-sided operations without knowing an rkey, and the only way to communicate an rkey is via a two-sided operation.</p>
<p>All Segments within a <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a> are associated with the same protection domain (PD), because all connections derive from a single listening id, and thus inherit its PD. Despite this simplicity, a Memory Node must maintain a collection of the ids that are created in response to Compute Nodes connecting to its listening id, so it can shut down gracefully.</p>
<p>Note that Remus allows a machine to function as both a Memory Node and a Compute Node. To avoid deadlock, the act of receiving connections on the listening id is performed by a separate thread, so that a co-located Compute Node context can try to connect to remote machines while receiving connections from those same machines. </p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a0b1e24af0fbdf3cd85642e0c47d32869" name="a0b1e24af0fbdf3cd85642e0c47d32869"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b1e24af0fbdf3cd85642e0c47d32869">&#9670;&#160;</a></span>ConnPtr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="classremus_1_1MemoryNode.html#a0b1e24af0fbdf3cd85642e0c47d32869">remus::MemoryNode::ConnPtr</a> =  std::shared_ptr&lt;<a class="el" href="classremus_1_1internal_1_1Connection.html">internal::Connection</a>&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A shared pointer to a Connection object. </p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="acf7b65b8b4ebdd9b75253f75fe4f907a" name="acf7b65b8b4ebdd9b75253f75fe4f907a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7b65b8b4ebdd9b75253f75fe4f907a">&#9670;&#160;</a></span>~MemoryNode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">remus::MemoryNode::~MemoryNode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>TODO: Need to make sure all fields get reclaimed/destructed properly. </p>

</div>
</div>
<a id="a23a92b1a0c0f6c5ecca7927dac3c97ed" name="a23a92b1a0c0f6c5ecca7927dac3c97ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23a92b1a0c0f6c5ecca7927dac3c97ed">&#9670;&#160;</a></span>MemoryNode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">remus::MemoryNode::MemoryNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structremus_1_1MachineInfo.html">MachineInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classremus_1_1ArgMap.html">remus::ArgMap</a> &gt;&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Construct a <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a></p>
<p>TODO: The seg size shouldn't be hard-coded. 1MB is certainly more than enough, so nothing is going to break right now, but all we really need is ~16B more than the size of ris_ </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aef24f2bc7597006bb687de2978e1a051" name="aef24f2bc7597006bb687de2978e1a051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef24f2bc7597006bb687de2978e1a051">&#9670;&#160;</a></span>get_local_rkeys()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structremus_1_1internal_1_1RegionInfo.html">internal::RegionInfo</a> &gt; remus::MemoryNode::get_local_rkeys </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Return a vector with the RegionInfo for this <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a>. This is a special-purpose function, used only for the situation where a <a class="el" href="classremus_1_1ComputeNode.html" title="A ComputeNode is a machine that can run ComputeThread (s)">ComputeNode</a> is also a <a class="el" href="classremus_1_1MemoryNode.html" title="A MemoryNode is a machine that provides Segments for ComputeNodes.">MemoryNode</a>. In that case, the <a class="el" href="classremus_1_1ComputeNode.html" title="A ComputeNode is a machine that can run ComputeThread (s)">ComputeNode</a> can't its own rkeys for use over the loopback in the standard way (i.e., it can't connect to itself and do a Send/Recv). </p>

</div>
</div>
<a id="a1e8e4d698d5ab2d8d18af4e750dc45a7" name="a1e8e4d698d5ab2d8d18af4e750dc45a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e8e4d698d5ab2d8d18af4e750dc45a7">&#9670;&#160;</a></span>handle_connections()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void remus::MemoryNode::handle_connections </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The main loop run by the listening thread. Polls for new events on the listening endpoint and handles them. This typically means receiving new connections, configuring the new endpoints, and then putting them into conns_. </p>

</div>
</div>
<a id="aae40a6aea42e7f99305c5fad74d345dd" name="aae40a6aea42e7f99305c5fad74d345dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae40a6aea42e7f99305c5fad74d345dd">&#9670;&#160;</a></span>init_done()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void remus::MemoryNode::init_done </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Stop listening for new connections, and terminate the listening thread</p>
<p>NB: This blocks the caller until the listening thread has been joined </p>

</div>
</div>
<a id="af533ae0d6e83d23a038b5747666a4ac0" name="af533ae0d6e83d23a038b5747666a4ac0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af533ae0d6e83d23a038b5747666a4ac0">&#9670;&#160;</a></span>on_connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void remus::MemoryNode::on_connect </td>
          <td>(</td>
          <td class="paramtype">rdma_cm_id *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">rdma_cm_event *&#160;</td>
          <td class="paramname"><em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ibv_pd *&#160;</td>
          <td class="paramname"><em>pd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Handler to run when a connection request arrives. </p>

</div>
</div>
<a id="af4f416826460d2ef587b93fb955d61a1" name="af4f416826460d2ef587b93fb955d61a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4f416826460d2ef587b93fb955d61a1">&#9670;&#160;</a></span>on_disconnect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void remus::MemoryNode::on_disconnect </td>
          <td>(</td>
          <td class="paramtype">rdma_cm_id *&#160;</td>
          <td class="paramname"><em>id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is not live code, we just have it here for reference. If we wanted to handle dropped connections gracefully, we could do something like this (but not exactly this). </p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3a2833d8b39669f868cd575eb873ffa9" name="a3a2833d8b39669f868cd575eb873ffa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a2833d8b39669f868cd575eb873ffa9">&#9670;&#160;</a></span>address_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string remus::MemoryNode::address_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aafd78320081297747eb7c00c7731070d" name="aafd78320081297747eb7c00c7731070d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aafd78320081297747eb7c00c7731070d">&#9670;&#160;</a></span>conns_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classremus_1_1MemoryNode.html#a0b1e24af0fbdf3cd85642e0c47d32869">ConnPtr</a>&gt; remus::MemoryNode::conns_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a71a29d9d6cb6e74578928cc957785a4d" name="a71a29d9d6cb6e74578928cc957785a4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71a29d9d6cb6e74578928cc957785a4d">&#9670;&#160;</a></span>listen_channel_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rdma_event_channel* remus::MemoryNode::listen_channel_ = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac50a81d813704cea668101626284a6b7" name="ac50a81d813704cea668101626284a6b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac50a81d813704cea668101626284a6b7">&#9670;&#160;</a></span>listen_id_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">rdma_cm_id* remus::MemoryNode::listen_id_ = nullptr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="abb735c7ec2ee8e43492901be1cd53521" name="abb735c7ec2ee8e43492901be1cd53521"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb735c7ec2ee8e43492901be1cd53521">&#9670;&#160;</a></span>mr_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceremus_1_1internal.html#ad19c6642dcb03734777590a5a5fecb62">internal::ibv_mr_ptr</a> remus::MemoryNode::mr_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="aa85b3cd8d63c1ea851247fb53a18dc6f" name="aa85b3cd8d63c1ea851247fb53a18dc6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa85b3cd8d63c1ea851247fb53a18dc6f">&#9670;&#160;</a></span>port_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t remus::MemoryNode::port_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a5df18d9fbe4af76ef18634ba9b62adae" name="a5df18d9fbe4af76ef18634ba9b62adae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5df18d9fbe4af76ef18634ba9b62adae">&#9670;&#160;</a></span>remaining_conns_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t remus::MemoryNode::remaining_conns_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9c44330824bf3f474ebcb873a39d418" name="ac9c44330824bf3f474ebcb873a39d418"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9c44330824bf3f474ebcb873a39d418">&#9670;&#160;</a></span>ris_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structremus_1_1internal_1_1RegionInfo.html">internal::RegionInfo</a>&gt; remus::MemoryNode::ris_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a47b58ac09270e6e99f558b8a41883ebd" name="a47b58ac09270e6e99f558b8a41883ebd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47b58ac09270e6e99f558b8a41883ebd">&#9670;&#160;</a></span>runner_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::thread remus::MemoryNode::runner_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a2dfa9a041602a192628cabd0aa023469" name="a2dfa9a041602a192628cabd0aa023469"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dfa9a041602a192628cabd0aa023469">&#9670;&#160;</a></span>segs_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structremus_1_1MemoryNode_1_1SegInfo.html">SegInfo</a>&gt; remus::MemoryNode::segs_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a3eb46341d958400600fa89364b056a8b" name="a3eb46341d958400600fa89364b056a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eb46341d958400600fa89364b056a8b">&#9670;&#160;</a></span>self_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structremus_1_1MachineInfo.html">MachineInfo</a> remus::MemoryNode::self_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="ad3ee26e30d727d8072172fc4628e6e51" name="ad3ee26e30d727d8072172fc4628e6e51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3ee26e30d727d8072172fc4628e6e51">&#9670;&#160;</a></span>send_seg_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classremus_1_1internal_1_1Segment.html">internal::Segment</a> remus::MemoryNode::send_seg_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>A segment that is registered with the RNIC in a manner that allows limited send() calls.</p>
<p>NB: This is not optimized for high-performance 2-sided operations. Its current use is limited to sending rkeys to ComputeNodes. Note that it does not require thread safety, since all Sends are currently blocking. </p>

</div>
</div>
<a id="aa11e003bb3358d96ba8cc043f824fa09" name="aa11e003bb3358d96ba8cc043f824fa09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa11e003bb3358d96ba8cc043f824fa09">&#9670;&#160;</a></span>total_threads_</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const uint64_t remus::MemoryNode::total_threads_</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="mem__node_8h_source.html">mem_node.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceremus.html">remus</a></li><li class="navelem"><a class="el" href="classremus_1_1MemoryNode.html">MemoryNode</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
